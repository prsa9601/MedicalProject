@page
@using MedicalProject.Infrastructure.Extensions
@model MedicalProject.Pages.Front.Notifications.IndexModel
@{
    ViewData["Title"] = "اعلان‌ها - پلتفرم دنگ";
}

<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>اعلان‌ها - پلتفرم دنگ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* تمام استایل‌های قبلی شما اینجا باقی می‌مانند */
        /* فقط استایل‌های مربوط به pagination را اضافه می‌کنیم */

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 2rem;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .page-item {
            display: inline-flex;
        }

        .page-link {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0.5rem 0.75rem;
            border: 1px solid #d1d5db;
            background-color: white;
            color: #374151;
            text-decoration: none;
            border-radius: 0.375rem;
            transition: all 0.2s;
            min-width: 2.5rem;
        }

            .page-link:hover {
                background-color: #f9fafb;
                border-color: #9ca3af;
            }

        .page-item.active .page-link {
            background-color: #2563eb;
            color: white;
            border-color: #2563eb;
        }

        .page-item.disabled .page-link {
            color: #9ca3af;
            pointer-events: none;
            background-color: #f9fafb;
            border-color: #e5e7eb;
        }

        .pagination-info {
            text-align: center;
            margin-top: 1rem;
            color: #6b7280;
            font-size: 0.875rem;
        }
    </style>
</head>
<body>
    <div class="min-h-screen bg-gray-50">
        <!-- Header -->
        <div class="bg-white shadow-sm border-b border-gray-200">
            <div class="max-w-4xl mx-auto px-4 py-8">
                <div class="flex flex-col md-flex-row justify-between items-start md-items-center space-y-4 md-space-y-0">
                    <div>
                        <h1 class="text-3xl font-bold text-gray-900">اعلان‌ها</h1>
                        @if (Model.Result?.Data?.Any() == true)
                        {
                            <p class="text-gray-600 mt-2">
                                @Model.Result.EntityCount اعلان یافت شد
                            </p>
                        }
                    </div>
                </div>
            </div>
        </div>

        <div class="max-w-4xl mx-auto px-4 py-8">
            <!-- Notifications List -->
            <div class="notifications-section">
                <div class="space-y-4">
                    @if (Model.Result == null || Model.Result.Data == null || !Model.Result.Data.Any())
                    {
                        <div class="card text-center py-8">
                            <div class="text-gray-500">
                                <i class="fas fa-bell-slash text-6xl mb-4"></i>
                                <p class="text-xl">اعلانی یافت نشد</p>
                            </div>
                        </div>
                    }
                    else
                    {
                        foreach (var item in Model.Result.Data)
                        {
                            <div class="card transition-all hover-shadow-md border-r-4 border-r-primary-500 bg-primary-50/30">
                                <div class="p-4">
                                    <div class="flex items-start space-x-4 space-x-reverse">
                                        <div class="p-2 rounded-full text-purple-600 bg-purple-50">
                                            <i class="fas fa-comment w-4 h-4"></i>
                                        </div>

                                        <div class="flex-1 min-w-0">
                                            <div class="flex items-start justify-between">
                                                <div class="flex-1">
                                                    <h3 class="text-sm font-medium text-gray-900">
                                                        @item.Title
                                                    </h3>
                                                    <p class="text-sm mt-1 text-gray-800">
                                                        @item.Description
                                                    </p>
                                                </div>
                                            </div>

                                            <div class="flex items-center justify-between mt-3">
                                                <span class="text-xs text-gray-500">
                                                    @(DateExtension.GetRelativeTimeAdvanced(item.CreationDate))
                                                </span>

                                                @if (!string.IsNullOrEmpty(item.Link))
                                                {
                                                    <a href="@item.Link" class="btn btn-outline btn-sm">
                                                        <i class="fas fa-external-link-alt w-3 h-3 ml-1"></i>
                                                        مشاهده
                                                    </a>
                                                }
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }
                    }
                </div>

                <!-- Pagination -->
                @if (Model.Result?.PageCount > 1)
                {
                    <div class="pagination">
                        <!-- Previous Page -->
                        @if (Model.Result.CurrentPage > 1)
                        {
                            <div class="page-item">
                                <a href="?currentPage=@(Model.Result.CurrentPage - 1)&take=@Model.Result.Take&Title=@Model.FilterParams.Title&Description=@Model.FilterParams.Description"
                                   class="page-link">
                                    <i class="fas fa-chevron-right"></i>
                                </a>
                            </div>
                        }
                        else
                        {
                            <div class="page-item disabled">
                                <span class="page-link">
                                    <i class="fas fa-chevron-right"></i>
                                </span>
                            </div>
                        }

                        <!-- Page Numbers -->
                        @for (int i = 1; i <= Model.Result.PageCount; i++)
                        {
                            if (i == Model.Result.CurrentPage)
                            {
                                <div class="page-item active">
                                    <span class="page-link">@i</span>
                                </div>
                            }
                            else
                            {
                                <div class="page-item">
                                    <a href="?currentPage=@i&take=@Model.Result.Take&Title=@Model.FilterParams.Title&Description=@Model.FilterParams.Description"
                                       class="page-link">@i</a>
                                </div>
                            }
                        }

                        <!-- Next Page -->
                        @if (Model.Result.CurrentPage < Model.Result.PageCount)
                        {
                            <div class="page-item">
                                <a href="?currentPage=@(Model.Result.CurrentPage + 1)&take=@Model.Result.Take&Title=@Model.FilterParams.Title&Description=@Model.FilterParams.Description"
                                   class="page-link">
                                    <i class="fas fa-chevron-left"></i>
                                </a>
                            </div>
                        }
                        else
                        {
                            <div class="page-item disabled">
                                <span class="page-link">
                                    <i class="fas fa-chevron-left"></i>
                                </span>
                            </div>
                        }
                    </div>

                    <div class="pagination-info">
                        نمایش @((Model.Result.CurrentPage - 1) * Model.Result.Take + 1) تا
                        @Math.Min(Model.Result.CurrentPage * Model.Result.Take, Model.Result.EntityCount)
                        از @Model.Result.EntityCount اعلان
                    </div>
                }
            </div>
        </div>
    </div>

    <script>
        // اضافه کردن قابلیت جستجو با انتر
        document.addEventListener('DOMContentLoaded', function() {
            // مدیریت فیلترها
            const filterInputs = document.querySelectorAll('input[type="text"]');

            filterInputs.forEach(input => {
                input.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        // وقتی کاربر انتر می‌زند، فرم submit شود
                        this.form.submit();
                    }
                });
            });

            // مدیریت لینک‌های pagination برای اضافه کردن اسکرول به بالا
            const pageLinks = document.querySelectorAll('.page-link[href*="currentPage"]');
            pageLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    // اسکرول به بالای صفحه بعد از کلیک
                    setTimeout(() => {
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                    }, 100);
                });
            });
        });
    </script>
</body>
</html>